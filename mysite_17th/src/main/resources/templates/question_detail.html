<html layout:decorate="~{layout}">
<div layout:fragment="content">
	<div class="container">
		<div class="jumbotron">
			<div class="display-4"><span class="small">ì§ˆë¬¸ì œëª© :</span> [[${question.subject}]]</div>
		</div>
		<div class="card bg-warning">
			<div class="card-body">
				<h5 class="card-title text-white"><span class="small">ì§ˆë¬¸ë‚´ìš© : </span><!--[[${question.content}]]-->
					<!-- ë§ˆí¬ë‹¤ìš´ ë¡œì§ -->
					<!-- th:utext ë¬¸ë²•ì€ í™”ë©´ì— ì´ìŠ¤ì¼€ì´í”„ ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šê³  ì¶œë ¥í•´ì¤€ë‹¤. -->
					<div th:utext="${@commonUtil.markdown(question.content)}"></div>
					
					<!-- ë“±ë¡ ë‚ ì§œ -->
					<span class="badge badge-pill badge-secondary float-right mr-2"
						th:text="${#temporals.format(question.createDate, 'ë“±ë¡ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
					<!-- ìˆ˜ì • ë‚ ì§œ -->
					<span class="badge badge-pill badge-secondary float-right mr-2"
						th:text="${#temporals.format(question.modifyDate, 'ìˆ˜ì •ë‚ ì§œ yyyy-MM-dd HH:mm')}"></span>
					<span class="badge badge-pill badge-secondary float-right mr-2" th:if="${question.author != null}"
						)>[[${question.author.username}]]</span>
				</h5>
			</div>
		</div>
		<!-- ì¢‹ì•„ìš” ë²„íŠ¼ -->
		<a href="javascript:void(0);" class="btn border mt-2 recommend"
			th:data-uri="@{|/question/vote/${question.id}|}">ğŸ‘ì¢‹ì•„ìš”<span
				class="bg badge-success">[[${#lists.size(question.voter)}]]</span></a>

		<!-- ì§ˆë¬¸ ìˆ˜ì • ë²„íŠ¼ -->
		<a th:href="@{|/question/modify/${question.id}|}" class="btn btn-success mt-2" sec:authorize="isAuthenticated()"
			th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}">ì§ˆë¬¸
			ìˆ˜ì •</a>

		<!-- ì§ˆë¬¸ ì‚­ì œ ë²„íŠ¼ -->
		<a href="javascript:void(0);" th:data-uri="@{|/question/delete/${question.id}|}"
			class="btn btn-danger mt-2 delete" sec:authorize="isAuthenticated()"
			th:if="${question.author != null and #authentication.getPrincipal().getUsername() == question.author.username}">ì§ˆë¬¸
			ì‚­ì œ</a>

		<h4 th:text="|${#lists.size(question.answerList)}ê°œì˜ ë‹µë³€ì´ ìˆìŠµë‹ˆë‹¤.|" class="my-5 border-bottom my-3 py-2"></h4>
		<!-- ${#lists.size()ëŠ” íƒ€ì„ë¦¬í”„ì—ì„œ ì œê³µí•˜ëŠ” ë¬¸ë²•ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ë¡œ ê°ì²´ë¥¼ ë„£ìœ¼ë©´ í•´ë‹¹ ê°ì²´ì˜ ê°¯ìˆ˜ë¥¼ ë¦¬í„´í•œë‹¤. -->

		<div>
			<ul class="list-unstyled">
				<div class="card bg-light my-3" th:each="answer : ${question.answerList}">
					<div class="card-body">
						<li>[[${answer.content}]]</li>

						<!-- ë‚ ì§œë¥¼ ì¶œë ¥í•˜ëŠ” ë°°ì§€ -->
						<div class="d-flex justify-content-end">
							<span class="badge badge-pill badge-info mr-2"
								th:if="${answer.author != null}">[[${answer.author.username}]]</span>
							<span class="badge badge-pill badge-info mr-2"
								th:text="${#temporals.format(answer.createDate, 'yyyy-MM-dd HH:mm')}"></span>
							<span class="badge badge-pill badge-info mr-2"
								th:text="${#temporals.format(answer.modifyDate, 'yyyy-MM-dd HH:mm')}"></span>
						</div>


						<!-- ë‹µë³€ ìˆ˜ì • ë²„íŠ¼ -->
						<div class="mt-3">
							<!-- ì¢‹ì•„ìš” ë²„íŠ¼ -->
							<a href="javascript:void(0);" class="btn border recommend"
								th:data-uri="@{|/answer/vote/${answer.id}|}">ğŸ‘ì¢‹ì•„ìš”<span
									class="bg badge-success">[[${#lists.size(answer.voter)}]]</span></a>
								<!-- #lists : íƒ€ì„ë¦¬í”„ í™•ì¥ë¬¸ë²•ìœ¼ë¡œ íƒ€ì„ë¦¬í”„ì—ì„œ ì œê³µí•˜ëŠ” ìœ í‹¸ë¦¬í‹° ê°ì²´ë¥¼ í‘œí˜„í•˜ëŠ” ë¬¸ë²•ì´ë‹¤. #dates, #strings, #lists, #numbers, #maps ë“±ì˜ ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¬¸ë²•-->
							<a th:href="@{|/answer/modify/${answer.id}|}" class="btn btn-success"
								sec:authorize="isAuthenticated()"
								th:if="${answer.author != null and #authentication.getPrincipal.getUsername() == answer.author.username}">ë‹µë³€
								ìˆ˜ì •</a>
							<a href="javascript:void(0);" th:data-uri="@{|/answer/delete/${answer.id}|}"
								class="btn btn-danger delete" sec:authorize="isAuthenticated()"
								th:if="${answer.author != null and #authentication.getPrincipal.getUsername() == answer.author.username}">ë‹µë³€
								ì‚­ì œ</a>
						</div>
					</div>
				</div>

			</ul>
		</div>

		<!-- ë‹µë³€ ì‘ì„± -->
		<form th:action="@{|/answer/create/${question.id}|}" method="post" th:object="${answerForm}">
			<!-- ìœ íš¨ì„± ê²€ì¦ ì—ëŸ¬ì‹œ ì—ëŸ¬ë‚´ìš© message ì¶œë ¥êµ¬ë¬¸ -->
			<div th:replace="~{form_errors :: formErrorFragment}"></div>
			<!-- <div class="alert alert-danger" th:if="${#fields.hasAnyErrors()}">
						<div th:each="err : ${#fields.allErrors()}" >[[${err}]]</div>
					
					</div> -->
			<div class="form-group mb-0">
				<textarea sec:authorize="isAnonymous()" name="content" id="content" cols="30" rows="10"
					class="form-control mb-0" disabled th:field="*{content}"
					placeholder="ë¡œê·¸ì¸í•œ ìƒíƒœì—ì„œ ë‹µë³€ ì‘ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤."></textarea><br /><br />
				<textarea sec:authorize="isAuthenticated()" name="content" id="content" cols="30" rows="10"
					class="form-control mb-0" th:field="*{content}"></textarea><br /><br />
				<!-- ë‹µë³€ ê¸°ëŠ¥ì˜ contentí•­ëª©ë„ th:field ì†ì„±ì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì˜ë¯¸ë¡œ th:field="*{content}"ë¥¼ ë„£ëŠ”ë‹¤! -->
			</div>
			<input type="submit" value="ë‹µë³€ ë“±ë¡í•˜ê¸°" class="btn btn-warning text-white p-3 mt-0" />
		</form>
	</div>
</div>
<script layout:fragment="script" type="text/javascript">
	const delete_elements = document.getElementsByClassName("delete")
	Array.from(delete_elements).forEach(function (element) {
		element.addEventListener("click", function () {
			if (confirm("ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
				location.href = this.dataset.uri
			}
		})
	})

	const recommend_elements = document.getElementsByClassName("recommend")
	Array.from(recommend_elements).forEach(function (element) {
		element.addEventListener("click", function () {
			if (confirm("ì •ë§ë¡œ ì¶”ì²œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
				location.href = this.dataset.uri
			}
		})
	})
</script>

</html>